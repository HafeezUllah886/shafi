<?php
 namespace App\Http\Controllers; use App\Http\Controllers\Controller; use App\Models\accounts; use App\Models\products; use Illuminate\Http\Request; use Illuminate\Support\Facades\DB; class SalesmanReceiveReportController extends Controller { public function index() { $salesmen = accounts::salesman()->get(); return view("\162\x65\x70\x6f\x72\x74\163\56\x73\x61\154\x65\x2e\151\156\144\x65\x78", compact("\x73\141\154\145\163\155\x65\156")); } public function data($from, $to, $salesman) { $salesman = accounts::find($salesman); $sales = DB::table("\163\x61\154\x65\x5f\144\x65\x74\x61\151\x6c\x73\x20\141\x73\40\160\x64")->join("\163\x61\x6c\x65\x73\x20\141\x73\40\160", "\160\56\151\x64", "\75", "\160\x64\x2e\x73\141\x6c\x65\163\x49\x44")->where("\160\56\143\x75\x73\164\x6f\155\x65\162\x49\104", $salesman->id)->whereBetween("\x70\x2e\x64\141\164\145", array($from, $to))->groupBy("\x70\x64\56\160\162\x6f\144\165\x63\x74\x49\104")->select("\160\x64\56\160\x72\157\144\165\x63\164\x49\104", DB::raw("\123\125\x4d\50\160\144\56\161\164\171\51\40\141\163\40\164\x6f\164\x61\154\137\161\164\171"))->get(); foreach ($sales as $sale) { $product = products::find($sale->productID); $sale->product_code = $product->code; $sale->product = $product->name; $sale->product_category = $product->category->name; $sale->product_stock = getStock($product->id); } return view("\162\x65\x70\157\162\x74\163\56\x73\x61\154\x65\56\x64\x65\x74\x61\151\154\163", compact("\146\162\157\x6d", "\x74\157", "\163\141\x6c\x65\x73\155\141\x6e", "\163\141\154\145\163")); } }