<?php
 namespace App\Http\Controllers; use App\Models\categories; use App\Models\products; use App\Models\units; use Illuminate\Http\Request; use Intervention\Image\ImageManager; use Intervention\Image\Drivers\Imagick\Driver; class ProductsController extends Controller { public function index() { $items = products::all(); $cats = categories::orderBy("\x6e\141\x6d\x65", "\x61\x73\143")->get(); return view("\160\x72\157\x64\165\143\164\x73\56\x70\162\157\x64\165\x63\x74", compact("\x69\x74\x65\155\x73", "\143\141\x74\163")); } public function create() { } public function store(Request $request) { $check = products::where(array("\x6e\x61\x6d\145" => $request->name, "\143\x6f\144\145" => $request->code, "\x63\141\x74\111\104" => $request->catID))->count(); if ($check > 0) { return back()->with("\x65\162\162\157\x72", "\x50\162\x6f\144\165\x63\164\x20\141\x6c\x72\145\141\x64\x79\x20\105\x78\x69\x73\164\x69\x6e\147"); } $product = products::create($request->all()); $photo_path1 = null; if ($request->hasFile("\x69\x6d\147")) { $image = $request->file("\151\155\147"); $filename = $request->code . "\x2e" . $image->getClientOriginalExtension(); $image_path = public_path("\57\x66\151\154\145\163\x2f\151\x74\x65\x6d\x73\57" . $filename); $photo_path1 = "\x2f\x66\151\x6c\x65\163\57\x69\x74\145\x6d\163\57" . $filename; $image->move(public_path("\x2f\x66\x69\154\x65\163\x2f\151\164\145\155\x73\57"), $filename); $product->update(array("\x69\155\147" => $photo_path1)); } return back()->with("\163\165\x63\143\x65\x73\x73", "\x50\162\x6f\144\165\x63\164\x20\x43\162\x65\x61\x74\x65\x64"); } public function show(products $products) { } public function edit(products $products) { } public function update(Request $request, $id) { $check = products::where(array("\x6e\141\155\145" => $request->name, "\143\x6f\x64\145" => $request->code, "\143\x61\x74\111\x44" => $request->catID))->where("\151\144", "\41\75", $id)->count(); if ($check > 0) { return back()->with("\145\162\162\x6f\162", "\x50\162\157\144\165\x63\164\40\x61\154\x72\145\141\x64\x79\x20\105\x78\x69\x73\164\x69\156\147"); } $product = products::find($id); $product->update($request->all()); $photo_path1 = null; if ($request->hasFile("\x69\155\x67")) { $image = $request->file("\151\x6d\x67"); $filename = $request->code . "\56" . $image->getClientOriginalExtension(); $image_path = public_path("\57\x66\x69\154\x65\163\x2f\x69\x74\x65\155\x73\x2f" . $filename); $photo_path1 = "\x2f\x66\x69\x6c\145\x73\x2f\x69\164\145\155\x73\57" . $filename; $image->move(public_path("\57\x66\151\x6c\x65\163\x2f\151\x74\145\x6d\x73\x2f"), $filename); $product->update(array("\151\x6d\x67" => $photo_path1)); } return back()->with("\163\x75\x63\x63\x65\x73\163", "\120\x72\x6f\144\x75\x63\x74\40\125\x70\144\141\x74\145\144"); } public function destroy(products $products) { } public function ajaxCreate(request $request) { $check = products::where("\x6e\x61\x6d\x65", $request->name)->count(); if ($check > 0) { return response()->json(array("\x72\x65\163\160\x6f\156\163\145" => "\105\170\151\x73\x74\163")); } $product = products::create($request->all()); return response()->json(array("\162\x65\163\160\x6f\x6e\x73\145" => $product->id)); } }