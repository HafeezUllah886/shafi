<?php
 namespace App\Http\Controllers; use App\Models\categories; use App\Models\products; use App\Models\stock; use App\Models\units; use App\Models\warehouses; use Illuminate\Http\Request; class StockController extends Controller { public function index(Request $request) { $cat = $request->category; if ($cat && $cat != 0) { $products = products::where("\143\141\x74\111\104", $cat)->get(); } else { $products = products::all(); } $warehouses = warehouses::all(); $categories = categories::all(); return view("\163\164\x6f\x63\153\56\151\156\x64\x65\170", compact("\x70\162\157\x64\x75\x63\x74\163", "\x77\x61\x72\x65\x68\x6f\x75\163\x65\x73", "\x63\141\x74\x65\x67\x6f\x72\151\x65\163", "\143\141\x74")); } public function create() { } public function store(Request $request) { } public function show($id, $warehouse, $from, $to) { $product = products::find($id); if ($warehouse == "\141\154\154") { $stocks = stock::where("\160\x72\157\144\x75\x63\164\111\x44", $id)->whereBetween("\144\x61\x74\145", array($from, $to))->get(); $pre_cr = stock::where("\x70\x72\157\144\165\143\164\x49\x44", $id)->whereDate("\x64\x61\164\145", "\74", $from)->sum("\143\162"); $pre_db = stock::where("\160\162\x6f\144\x75\x63\x74\111\x44", $id)->whereDate("\144\141\x74\145", "\74", $from)->sum("\x64\x62"); $cur_cr = stock::where("\160\x72\157\x64\x75\143\164\111\104", $id)->sum("\x63\162"); $cur_db = stock::where("\x70\x72\157\x64\165\143\164\111\104", $id)->sum("\x64\142"); } else { $stocks = stock::where("\x70\x72\157\x64\x75\x63\164\x49\x44", $id)->whereBetween("\x64\141\x74\145", array($from, $to))->where("\167\141\162\145\150\157\165\163\x65\x49\104", $warehouse)->get(); $pre_cr = stock::where("\160\162\x6f\x64\x75\143\164\111\x44", $id)->whereDate("\144\x61\x74\145", "\x3c", $from)->where("\167\x61\x72\145\x68\157\165\163\x65\x49\104", $warehouse)->sum("\143\162"); $pre_db = stock::where("\160\162\x6f\144\x75\143\x74\x49\104", $id)->whereDate("\144\x61\x74\x65", "\x3c", $from)->where("\x77\141\162\145\x68\x6f\x75\163\145\x49\104", $warehouse)->sum("\x64\x62"); $cur_cr = stock::where("\x70\x72\x6f\x64\165\143\164\111\x44", $id)->where("\x77\141\162\145\x68\157\165\163\145\x49\104", $warehouse)->sum("\x63\x72"); $cur_db = stock::where("\x70\x72\157\144\x75\x63\x74\111\104", $id)->where("\167\x61\162\145\150\x6f\x75\x73\x65\x49\104", $warehouse)->sum("\x64\x62"); } $pre_balance = $pre_cr - $pre_db; $cur_balance = $cur_cr - $cur_db; return view("\x73\x74\157\143\153\56\144\x65\164\x61\x69\154\x73", compact("\x70\x72\x6f\144\x75\143\164", "\x70\x72\145\x5f\x62\141\x6c\x61\156\x63\x65", "\143\165\x72\x5f\142\x61\154\x61\x6e\x63\145", "\163\164\x6f\x63\x6b\163", "\x66\x72\157\155", "\x74\157")); } public function edit(stock $stock) { } public function update(Request $request, stock $stock) { } public function destroy(stock $stock) { } }